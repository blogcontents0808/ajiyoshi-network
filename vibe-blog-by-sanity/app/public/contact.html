<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お問い合わせ｜味美ネットワーク</title>
    <link rel="stylesheet" href="/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
</head>
<body>

    <header class="header">
        <div class="container">
            <a href="/index.html" class="header-logo">
                <img src="/images/kantaro_yoroshiku.png" alt="炭ぬり貫太郎" class="logo-character">
                <h1>味美ネットワーク</h1>
            </a>
            <nav class="header-nav">
                <ul>
                    <li><a href="/home">ホーム</a></li>
                    <li><a href="/home">味美ネットワークとは</a></li>
                    <li><a href="/api/static/members.html">メンバー紹介</a></li>
                    <li><a href="/api/static/history.html">沿革</a></li>
                    <li><a href="/api/static/activities.html">活動内容</a></li>
                    <li><a href="/">ブログ</a></li>
                    <li><a href="/api/static/contact.html">お問い合わせ</a></li>
                </ul>
            </nav>
            <button class="hamburger-btn" id="hamburger-btn" aria-label="メニューを開く">
                <span></span>
                <span></span>
                <span></span>
            </button>
        </div>
    </header>

    <main>
        <section class="page-hero">
            <div class="container">
                <h2 class="page-title">お問い合わせ</h2>
                <p>ご意見・ご質問など、お気軽にお問い合わせください。</p>
            </div>
        </section>
        <section class="section">
            <div class="container modern-form-wrapper">
                <div class="form-info">
                    <h3>お問い合わせについて</h3>
                    <p>いただいたお問い合わせには、原則として3営業日以内にご返信いたします。</p>
                    <p>万が一返信がない場合は、メールアドレスの入力間違いの可能性がございますので、お手数ですが再度お問い合わせください。</p>
                    <p>味美ネットワークの活動に関するご意見や、イベント参加に関するご質問など、どんなことでもお気軽にご連絡ください。</p>
                </div>
                <form id="contactForm" method="POST">
                    <div class="form-group floating">
                        <input type="text" id="name" name="name" placeholder=" " required>
                        <label for="name">お名前 <span class="required">必須</span></label>
                    </div>
                    <div class="form-group floating">
                        <input type="email" id="email" name="email" placeholder=" " required>
                        <label for="email">メールアドレス <span class="required">必須</span></label>
                    </div>
                    <div class="form-group floating">
                        <input type="text" id="subject" name="subject" placeholder=" ">
                        <label for="subject">件名</label>
                    </div>
                    <div class="form-group floating">
                        <textarea id="message" name="message" rows="6" placeholder=" " required></textarea>
                        <label for="message">お問い合わせ内容 <span class="required">必須</span></label>
                    </div>
                    <div class="form-submit">
                        <button type="submit" class="btn" id="submitBtn">
                            <i class="fas fa-paper-plane"></i> 送信する
                        </button>
                    </div>
                    <div id="formMessage" style="margin-top: 20px; padding: 15px; border-radius: 5px; display: none;"></div>
                </form>
            </div>
        </section>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="social-links">
                <a href="https://www.facebook.com/watch/?v=1872150119939498" target="_blank" rel="noopener noreferrer" aria-label="Facebook"><i class="fab fa-facebook-f"></i></a>
                <a href="https://www.instagram.com/ajiyoshi.net.work/" target="_blank" rel="noopener noreferrer" aria-label="Instagram"><i class="fab fa-instagram"></i></a>
            </div>
            <p>© 2024 味美ネットワーク. All Rights Reserved.</p>
        </div>
    </footer>

    <script src="/script.js"></script>
    <script>
        // お問い合わせフォームの処理
        document.getElementById('contactForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const submitBtn = document.getElementById('submitBtn');
            const formMessage = document.getElementById('formMessage');
            const originalBtnText = submitBtn.innerHTML;
            
            // 送信中の表示
            submitBtn.disabled = true;
            submitBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> 送信中...';
            formMessage.style.display = 'none';
            
            try {
                // フォームデータの収集
                const formData = {
                    name: document.getElementById('name').value.trim(),
                    email: document.getElementById('email').value.trim(),
                    subject: document.getElementById('subject').value.trim(),
                    message: document.getElementById('message').value.trim()
                };
                
                // API呼び出し
                const response = await fetch('/api/contact', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });
                
                const result = await response.json();
                
                if (response.ok && result.success) {
                    // 成功時
                    formMessage.style.display = 'block';
                    formMessage.style.background = 'linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%)';
                    formMessage.style.color = 'white';
                    formMessage.innerHTML = `
                        <div style="display: flex; align-items: center;">
                            <i class="fas fa-check-circle" style="margin-right: 10px; font-size: 20px;"></i>
                            <div>
                                <strong>送信完了！</strong><br>
                                ${result.message}<br>
                                <small>確認メールをお送りしましたのでご確認ください。</small>
                            </div>
                        </div>
                    `;
                    
                    // フォームをリセット
                    document.getElementById('contactForm').reset();
                    
                    // 3秒後にサンクスページにリダイレクト
                    setTimeout(() => {
                        window.location.href = '/api/static/thanks.html';
                    }, 3000);
                    
                } else {
                    // エラー時
                    throw new Error(result.error || 'お問い合わせの送信に失敗しました。');
                }
                
            } catch (error) {
                console.error('送信エラー:', error);
                
                formMessage.style.display = 'block';
                formMessage.style.background = 'linear-gradient(135deg, #ff6b6b 0%, #ffa8a8 100%)';
                formMessage.style.color = 'white';
                formMessage.innerHTML = `
                    <div style="display: flex; align-items: center;">
                        <i class="fas fa-exclamation-triangle" style="margin-right: 10px; font-size: 20px;"></i>
                        <div>
                            <strong>送信エラー</strong><br>
                            ${error.message}<br>
                            <small>時間をおいて再度お試しください。</small>
                        </div>
                    </div>
                `;
            } finally {
                // ボタンを元に戻す
                submitBtn.disabled = false;
                submitBtn.innerHTML = originalBtnText;
            }
        });
    </script>
</body>
</html>